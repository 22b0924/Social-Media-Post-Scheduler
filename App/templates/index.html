<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Social Scheduler (Demo)</title>
  <style>
    body { font-family: Arial, sans-serif; max-width:900px; margin:30px auto; }
    textarea { width:100%; }
    .row { margin:8px 0; }
    pre { background:#f4f4f4; padding:12px; }
  </style>
</head>
<body>
  <h2>Social Media Post Scheduler â€” Demo</h2>
  <form id="frm">
    <div class="row">
      <label>Content:</label><br/>
      <textarea id="content" rows="3" placeholder="Write post..."></textarea>
    </div>
    <div class="row">
      <label>Platforms (comma separated):</label><br/>
      <input id="platforms" value="twitter,linkedin" style="width:100%"/>
    </div>
    <div class="row">
      <label>Post at (local):</label><br/>
      <input id="post_at" type="datetime-local" />
      <small>Pick a time a minute or two ahead for quick demo</small>
    </div>
    <div class="row">
      <button type="submit">Schedule</button>
      <button type="button" onclick="refresh()">Refresh</button>
    </div>
  </form>

  <h3>Scheduled / Recent Posts</h3>
  <pre id="out">Loading...</pre>

<script>
async function refresh(){
  const r = await fetch('/posts');
  const j = await r.json();
  document.getElementById('out').textContent = JSON.stringify(j, null, 2);
}
document.getElementById('frm').onsubmit = async (e) => {
  e.preventDefault();
  const content = document.getElementById('content').value;
  const platforms = document.getElementById('platforms').value;
  const postAtRaw = document.getElementById('post_at').value;
  if (!content || !platforms || !postAtRaw) { alert('fill all'); return; }
  // Convert local datetime to ISO string
  const iso = new Date(postAtRaw).toISOString();
  await fetch('/schedule', {
    method: 'POST',
    headers: { 'Content-Type':'application/json' },
    body: JSON.stringify({ platform: platforms, content, post_at: iso })
  });
  alert('Scheduled');
  refresh();
}
refresh();
</script>
</body>
</html>

